function NeuralNetwork(){this.W1=[[.22911823424552846,-.38395520339458944,-.5194093427754107,-.6095937024253613,.13386390961363137,.816521161974082,.06747053289969562,.02477350100868092,.36186300019130435,-.17329994257841674,.8804609379650326,.9368655429246333,.5255559172231563,.6885651819767311,-.9559777971177081,-.6198021049542288],[.4636179097430513,-.800905252182682,-.008310186810453146,-.3714031631398007,.5396727272325772,.2983772561395841,.6708391896451875,-.7745002132908487,.6595467164507616,.0140294413432418,-.5280877884751605,.47337289418561745,-.24861334074748198,.5794276767286517,.6029883329246721,.34918340912156687],[.18659944625183433,-.5669708443220807,-.8102855658853216,-.518566065578868,-.12164710284440705,.09153217710132378,.24729055870447336,.2947066063378636,-.4358583338270301,.40282599381873174,.5194958977780755,.074008588351552,-.00760182298280121,-.800648214770916,.9303301660392713,.20289556525580288],[.6644207580370867,-.5634944079547819,-.24250968297636044,-.8694181334371214,.0558399971818444,-.9296648614712941,-.7713597399235925,-.6519011501445395,-.7833455820398023,-.9867640351102795,-.6447826448429019,.2636665394091202,-.7937366938036905,.1602643809884281,-.7904129803742164,.3614654099508763],[-.4911606002466855,-.8702452786910126,.3578487358056508,-.630829815720221,-.45270176200747736,.3335578454637087,-.29469903970009526,.597977154148992,-.8213715645772579,-.7151437259000422,.9476365750514648,-.22861974024714593,-.2910566441780862,-.6054596318070771,.39302991360344075,-.3497549558031361],[-.3144356687878145,-.9498461248617587,-.12179420037855948,-.14272807508291718,.24826532186916728,-.25019474312036794,-.08646717091051936,.7147384499711857,-.7781475444519184,-.398840825121904,-.5715016688005332,-.60791337585988,-.28564364541670617,-.6211407884133586,.5298082472030945,-.9613724448974494],[-.9804082891011876,-.06233411145412093,-.2321023396953361,-.5836611520566013,-.11610932190755818,-.46779541868547003,.30477787853988936,-.8436059365256825,-.9298939543087577,.5835150506875153,-.39960271181294393,-.08757765951085483,.5051906066516652,-.20490095770221917,-.9899663757761332,.18273425304871926],[-.12191975280682055,-.7905495808946101,-.031883178864356765,.5602245067136473,.9714953436341807,.4280998733586796,-.6147236990949869,.6761748842424615,.13646029215642885,.7760558882011237,.5343906080011416,.7431691750611051,.247210914118551,.576526080062933,-.13798340789455166,.8596719752688768],[.8841259885737012,.6019390672394733,.3816860800133637,.4626629712176764,.5693803607240291,-.7727217213635806,.931574561092916,-.39557538424624417,-.5645102910846265,-.2930270361196108,-.3040507932591483,.14379706414756965,.3308909536748863,-.05422309142779724,.15437678297483348,-.7903338543292246],[.4852493583774766,-.3879762692047768,-.3014089640139681,-.21704405052725573,.25617828684437427,-.0051576355052738165,-.24469062774489725,.10312678221909266,.3382861843528957,-.08522534557729244,.3922508606266404,-.572062724567771,.3120670158909675,.6413268284841656,-.08874959201894006,.5485295835191559],[-.46630965567604843,.5298317814375975,.9903749865307199,-.06815809077589785,-.44463451592202263,-.603637883994963,.3910422330087382,.8776014999840136,-.877369279031559,-.21821985547415323,-.7326912953278737,-.2357943009067771,-.32153442907762875,-.46240018938900107,.13176115402185662,.4105250483069911],[-.8356900430343024,-.18115014908720894,-.3703550178659758,-.3597063075791356,.13030028088313061,.11858485088312021,-.9034914910571166,.6724221391111587,-.10176818827694012,-.389410765928051,-.982679209673682,.741029516912334,-.6698087510731585,-.8174649724262175,.982783878207727,-.6672294172505637],[-.4919435015739131,.7853285878441829,-.5717662453195951,.9421470576771518,.0013411707438892861,-.1675506721369353,.549616441572363,.8954569158620136,-.2886318219192887,.6694262185011586,-.20586678001848435,-.25021105816646694,-.001503901745842029,-.7963430842900232,-.9196014176620428,.6717367244687402],[-.8121498638136364,.09592697778702686,-.27055918969895787,.274730743803274,.7031595241484077,-.000835619136845267,.9026078833969962,-.6218221167582625,.18804699761934973,.791980584239349,.7153218836778992,-.9252262923764039,-.09425276601979915,-.29380685133296236,-.522361207485369,.9077936803372144],[-.0982761010892883,.219267943509049,-.3797042924569727,-.5761409304464347,-.030043020739916493,-.19112730743461803,.436383840208753,-.43906747484583386,-.6224778710583707,.9657950170675758,-.9172209314186617,.5262555257373154,-.1790930359285956,.07266569612699714,-.2867351118625483,-.3761544639619636],[.8296743504242166,.06889534875761427,.17043621941421438,-.3682416283459329,-.6543237682710199,.29039039307735903,.26661693044450274,-.9892066266041786,-.9876965247603793,-.2429109335954971,-.45051678323314004,-.6293635401571112,.6355701284680348,.908140618451581,-.5316756473353941,.17124498122608456],[.03146966097960435,-.41322877241558853,-.6728879808025101,.4582253951940558,.9694898523954047,-.797341947267499,-.26890208136082494,.6441784738845056,.33415393098060875,.15691494952233764,.5000248606913655,-.5116437816080825,.7911714620032564,-.10834160724506248,-.9113302643790999,-.6598152781527546],[-.9599432508197245,.8496920150063474,-.9897273749556663,-.3330939754080635,-.6538453515613978,-.28371105142105657,-.8857809918166692,-.527717536680937,.07000563479339439,-.06985520629810216,.7109340514172438,-.8892324776988785,-.45030417256003386,.7354102077594544,-.9277461032251146,.171550220745448],[.9318195262463393,.884922939459218,-.2155547564521929,.2211634095636299,-.23139894212759327,-.27898580268462103,.6694793338654823,-.11636912934531107,.23956768729191635,.06613050952188404,-.8108008125493282,.9368809222362064,.17888520043200407,.2549255142552127,-.7883105095800405,.6626793238339577],[-.3349922899751334,-.055337973334820045,.5659092483677477,.7549723347009181,-.939036673954488,-.24278781789419845,.2437283474300589,.43161190183535014,-.33192955151594195,.7588550054822116,-.29271863993297087,-.7786129308390457,-.9217692605139973,-.8018188876991137,-.5815494169507347,.44052526952380555],[-.5171707956516634,.5365735831330811,-.5084680752081203,.4719379964971493,.797828821859643,.7148078884831288,-.9606993301409337,.9422295753234353,-.8729619706333991,-.7972051261564448,-.9978074058276083,-.8856350538621363,-.51261212252995,.7165837169403435,-.2600011329965892,-.22553620856810763],[-.04307133200968405,-.49526972397291225,-.6694327036217644,-.1375144501928358,-.5199037798244022,.5768144435473035,.13872069353693295,-.4477681140887948,-.29435764608055637,-.015360287279733154,.7276813843538861,.37040005103294016,-.42749928677339843,-.381518650544161,.42940409408517866,-.08578425330565409],[-.8442914482705022,-.4328814960098679,-.9482784907628048,-.27059512452123524,.14616187925735202,-.44050344529428864,-.24420135702474388,-.48716381555563215,-.33524612977039103,.15106301158627522,.4234234541917816,.9188185809646816,.7245708667104611,-.5106091643240642,.7692918862614033,-.5979130372656027],[-.05323166645418009,.19898874763216856,-.693310027597779,.8690926968837882,.7024272144147452,-.13632098920753055,.18099225060778723,.4764898907858508,.6329825923579189,.5599087336006239,.14752814438148043,-.19862356090339084,-.33855365901789014,-.6918562439506104,.6401412485130447,-.31422143884971687],[.9198618964512271,-.9085434574939062,-.07565806068911662,-.5494253827710445,.2655614039368599,.7131011737641324,.8195949313694859,-.6373292540641295,-.9924840468123715,.6923626169088277,-.05621939843405466,-.35653081712353885,-.9999464658620689,-.9724007384549824,-.4092141782519212,-.17291981592327632]],this.W2=[[-.3577785399646656,.19300174833930894,-.006247931821872665,-.8640785144943233,-.02636397037458016,.7086929764697074,-.9678527963144834,-.6528626655876884],[-.8253768261352405,-.5671177169154191,.45484305767531064,-.3502346989348766,.5027642260601599,.6754540463944227,.6722913264945145,.6501012226470797],[.0001865733031625183,.458724910670786,-.2177452837070506,.4468517091545454,.25435360000786034,.29277504723796266,-.9566132077960972,.48135746733452667],[-.3448112162036878,-.8168772200028434,.9534028337998839,-.006687009797161192,-.9738791702942908,-.19962865313811973,-.310342209791199,.42073600626713015],[.6253333109296606,.08079836473626445,-.4581749089956104,-.1611345946541216,-.7679920125565394,-.3127490897928822,.9255473754607166,.8568138354035582],[.12798230878247052,.6038891999917286,-.3883519523847543,-.30585712183499725,.6440931441235649,.9252876045907121,-.5594086705223642,.007663229699182317],[.7219221086185188,-.24683674665622268,.3827872283473197,-.3436357568797552,.7203935636829208,.2375532962672091,-.9799883919085213,-.1725755052830915],[-.4229865262763215,-.2228762171613643,-.1285303319236073,.5383620068890687,.3202337279810137,-.4107217597963304,.7387573999940131,.48507772865651066],[-.30578885404166023,.38907862121743175,.2850613686850756,.6877775574427472,.2510089890888705,.07891071354268675,.6498247861802171,.8379924090901523],[.22749370635787036,.1441269023425953,.8738984771258971,.7576256801557939,-.41046406704754634,.5871947211165351,.8656808011299617,-.4830540021180436],[.3415785307189019,.7343372335559595,.35452711802484504,.3970927627552103,-.045331450167483744,.3503560110040054,-.4228814864548194,.49513411545656405],[-.43683396365988925,-.015800957077542144,-.981984698921484,-.6525929892334483,.9193681216255052,.25257372913001674,.48451195693889515,.4715518070160001],[-.13563167917724828,.955230751921623,.1960298765599151,-.837416481255524,.28978650107148685,-.20779296985066065,.24205166488505547,.05771624252686047],[.2999035954230247,.533600847938422,-.8215696937345336,-.7561650446156758,.6164459874834067,-.2875897301914634,.6075447688909068,.8152282805119482],[.38207636404007017,-.20030337081558036,.3023005769479572,-.5464676621096123,.4681571154393058,-.8019973567655523,-.5396695832098306,-.0019816954163731637],[-.15441270390448025,.7716264318518533,.8001041489495355,.11623169515432741,-.7966311362008875,-.08755901535460664,.6739884060843058,.352761899053315]],this.W3=[[.7057576147881934,.9219819295243479,.008765499139667732,.667259636247759],[-.5446038747597668,-.6805166908504714,-.37441332491553236,.25178416326337105],[-.1042499394145735,.2415168476449776,.04339011795775338,.050055902361555216],[.01816562158672408,-.46254340365858715,-.6123508169199359,-.905285857093892],[-.14302899427758398,-.5681812147884573,-.8700175214585144,.21886674868890843],[.881196814080278,.6943194804855222,.7264224475701275,-.6629180709854321],[-.32694951092932056,-.7130330636451458,.7228157845191001,.8198034006003532],[-.6154297460002565,-.8661821182159262,-.9342640326134513,.04373167466890404]],this.bias1=[-.0023758670168909646,-.28712033623793687,.0802088123987783,.9835323525944566,.8328840508572921,.819850543760881,.3782571437955151,.24222685706252634,-.2811048575880495,.8036127051477568,-.723446852992597,.4343884619750362,-.29447335005270503,-.2920591626145539,.6089586846600694,-.7873644767872512],this.bias2=[.35559700438558917,.9846998591793743,.27425547868325717,.1902335067128602,-.05935915606134179,.8365216092285905,-.08262884558423567,-.12391424026338305],this.bias3=[-.44763896832919414,.804936458355908,.7550132372322631,-.5047491727149565],this.W=[this.W1,this.W2,this.W3],this.L=4,this.bias=[this.bias1,this.bias2,this.bias3],this.a=[[],[],[]],this.output,this.input=[],this.offset_layer=[0,4.5,8.5,10.5],this.spacing=[1,5,9,13],this.nodeNumber=[this.W1.length,this.W2.length,this.W3.length,this.W3[0].length],this.diameter=15,this.maxValue=0,this.alpha=100,this.relu=function(t){return max(0,t)},this.forwardPropagation=function(t){this.input=[...t],x=[...t];for(let t=0;t<this.W.length;t++){for(let i=0;i<this.W[t][0].length;i++){this.a[t][i]=0;for(let s=0;s<this.W[t].length;s++)this.a[t][i]+=this.W[t][s][i]*x[s];t!=this.W.length-1?this.a[t][i]=this.relu(this.a[t][i]+this.bias[t][i]):this.a[t][i]=this.a[t][i]+this.bias[t][i],this.a[t][i]>this.maxValue&&(this.maxValue=this.a[t][i])}x=[...this.a[t]]}return x},this.predict=function(t){switch(this.y=this.forwardPropagation(t),this.output=this.y.indexOf(max(this.y)),this.output){case 0:res=LEFT_ARROW;break;case 1:res=DOWN_ARROW;break;case 2:res=RIGHT_ARROW;break;case 3:res=UP_ARROW}return res},this.drawNeuralNetwork=function(){for(let t=0;t<this.L-1;t++)for(let i=0,s=this.offset_layer[t];i<this.nodeNumber[t];i++,s++)for(let h=0,e=this.offset_layer[t+1];h<this.nodeNumber[t+1];h++,e++)0==t?stroke(map(this.input[i],0,1,200,20),this.alpha):stroke(map(this.a[t-1][i],0,this.maxValue,200,20),this.alpha),line(s*RESOLUTION_NEURALNETWORK,this.spacing[t]*RESOLUTION_NEURALNETWORK,e*RESOLUTION_NEURALNETWORK,this.spacing[t+1]*RESOLUTION_NEURALNETWORK);stroke(0);for(let t=0;t<this.L;t++)for(let i=0,s=this.offset_layer[t];i<this.nodeNumber[t];i++,s++){switch(t){case this.L-1:fill(255),i==this.output&&fill(0,0,255);break;case 0:white=map(this.input[i],0,1,255,0),fill(255,white,white);break;default:white=map(this.a[t-1][i],0,this.maxValue,255,0),fill(255,white,white)}ellipse(s*RESOLUTION_NEURALNETWORK,this.spacing[t]*RESOLUTION_NEURALNETWORK,this.diameter)}fill(0),text("L",this.offset_layer[this.L-1]*RESOLUTION_NEURALNETWORK-4,(this.spacing[this.L-1]+1)*RESOLUTION_NEURALNETWORK),text("D",(this.offset_layer[this.L-1]+1)*RESOLUTION_NEURALNETWORK-4,(this.spacing[this.L-1]+1)*RESOLUTION_NEURALNETWORK),text("R",(this.offset_layer[this.L-1]+2)*RESOLUTION_NEURALNETWORK-4,(this.spacing[this.L-1]+1)*RESOLUTION_NEURALNETWORK),text("U",(this.offset_layer[this.L-1]+3)*RESOLUTION_NEURALNETWORK-4,(this.spacing[this.L-1]+1)*RESOLUTION_NEURALNETWORK)}}