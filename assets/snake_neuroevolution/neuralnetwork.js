function NeuralNetwork(){
    this.W1 = [[0.22911823424552846,-0.38395520339458944,-0.5194093427754107,-0.6095937024253613,0.13386390961363137,0.816521161974082,0.06747053289969562,0.02477350100868092,0.36186300019130435,-0.17329994257841674,0.8804609379650326,0.9368655429246333,0.5255559172231563,0.6885651819767311,-0.9559777971177081,-0.6198021049542288],
    [0.4636179097430513,-0.800905252182682,-0.008310186810453146,-0.3714031631398007,0.5396727272325772,0.2983772561395841,0.6708391896451875,-0.7745002132908487,0.6595467164507616,0.0140294413432418,-0.5280877884751605,0.47337289418561745,-0.24861334074748198,0.5794276767286517,0.6029883329246721,0.34918340912156687],
    [0.18659944625183433,-0.5669708443220807,-0.8102855658853216,-0.518566065578868,-0.12164710284440705,0.09153217710132378,0.24729055870447336,0.2947066063378636,-0.4358583338270301,0.40282599381873174,0.5194958977780755,0.074008588351552,-0.00760182298280121,-0.800648214770916,0.9303301660392713,0.20289556525580288],
    [0.6644207580370867,-0.5634944079547819,-0.24250968297636044,-0.8694181334371214,0.0558399971818444,-0.9296648614712941,-0.7713597399235925,-0.6519011501445395,-0.7833455820398023,-0.9867640351102795,-0.6447826448429019,0.2636665394091202,-0.7937366938036905,0.1602643809884281,-0.7904129803742164,0.3614654099508763],
    [-0.4911606002466855,-0.8702452786910126,0.3578487358056508,-0.630829815720221,-0.45270176200747736,0.3335578454637087,-0.29469903970009526,0.597977154148992,-0.8213715645772579,-0.7151437259000422,0.9476365750514648,-0.22861974024714593,-0.2910566441780862,-0.6054596318070771,0.39302991360344075,-0.3497549558031361],
    [-0.3144356687878145,-0.9498461248617587,-0.12179420037855948,-0.14272807508291718,0.24826532186916728,-0.25019474312036794,-0.08646717091051936,0.7147384499711857,-0.7781475444519184,-0.398840825121904,-0.5715016688005332,-0.60791337585988,-0.28564364541670617,-0.6211407884133586,0.5298082472030945,-0.9613724448974494],
    [-0.9804082891011876,-0.06233411145412093,-0.2321023396953361,-0.5836611520566013,-0.11610932190755818,-0.46779541868547003,0.30477787853988936,-0.8436059365256825,-0.9298939543087577,0.5835150506875153,-0.39960271181294393,-0.08757765951085483,0.5051906066516652,-0.20490095770221917,-0.9899663757761332,0.18273425304871926],
    [-0.12191975280682055,-0.7905495808946101,-0.031883178864356765,0.5602245067136473,0.9714953436341807,0.4280998733586796,-0.6147236990949869,0.6761748842424615,0.13646029215642885,0.7760558882011237,0.5343906080011416,0.7431691750611051,0.247210914118551,0.576526080062933,-0.13798340789455166,0.8596719752688768],
    [0.8841259885737012,0.6019390672394733,0.3816860800133637,0.4626629712176764,0.5693803607240291,-0.7727217213635806,0.931574561092916,-0.39557538424624417,-0.5645102910846265,-0.2930270361196108,-0.3040507932591483,0.14379706414756965,0.3308909536748863,-0.05422309142779724,0.15437678297483348,-0.7903338543292246],
    [0.4852493583774766,-0.3879762692047768,-0.3014089640139681,-0.21704405052725573,0.25617828684437427,-0.0051576355052738165,-0.24469062774489725,0.10312678221909266,0.3382861843528957,-0.08522534557729244,0.3922508606266404,-0.572062724567771,0.3120670158909675,0.6413268284841656,-0.08874959201894006,0.5485295835191559],
    [-0.46630965567604843,0.5298317814375975,0.9903749865307199,-0.06815809077589785,-0.44463451592202263,-0.603637883994963,0.3910422330087382,0.8776014999840136,-0.877369279031559,-0.21821985547415323,-0.7326912953278737,-0.2357943009067771,-0.32153442907762875,-0.46240018938900107,0.13176115402185662,0.4105250483069911],
    [-0.8356900430343024,-0.18115014908720894,-0.3703550178659758,-0.3597063075791356,0.13030028088313061,0.11858485088312021,-0.9034914910571166,0.6724221391111587,-0.10176818827694012,-0.389410765928051,-0.982679209673682,0.741029516912334,-0.6698087510731585,-0.8174649724262175,0.982783878207727,-0.6672294172505637],
    [-0.4919435015739131,0.7853285878441829,-0.5717662453195951,0.9421470576771518,0.0013411707438892861,-0.1675506721369353,0.549616441572363,0.8954569158620136,-0.2886318219192887,0.6694262185011586,-0.20586678001848435,-0.25021105816646694,-0.001503901745842029,-0.7963430842900232,-0.9196014176620428,0.6717367244687402],
    [-0.8121498638136364,0.09592697778702686,-0.27055918969895787,0.274730743803274,0.7031595241484077,-0.000835619136845267,0.9026078833969962,-0.6218221167582625,0.18804699761934973,0.791980584239349,0.7153218836778992,-0.9252262923764039,-0.09425276601979915,-0.29380685133296236,-0.522361207485369,0.9077936803372144],
    [-0.0982761010892883,0.219267943509049,-0.3797042924569727,-0.5761409304464347,-0.030043020739916493,-0.19112730743461803,0.436383840208753,-0.43906747484583386,-0.6224778710583707,0.9657950170675758,-0.9172209314186617,0.5262555257373154,-0.1790930359285956,0.07266569612699714,-0.2867351118625483,-0.3761544639619636],
    [0.8296743504242166,0.06889534875761427,0.17043621941421438,-0.3682416283459329,-0.6543237682710199,0.29039039307735903,0.26661693044450274,-0.9892066266041786,-0.9876965247603793,-0.2429109335954971,-0.45051678323314004,-0.6293635401571112,0.6355701284680348,0.908140618451581,-0.5316756473353941,0.17124498122608456],
    [0.03146966097960435,-0.41322877241558853,-0.6728879808025101,0.4582253951940558,0.9694898523954047,-0.797341947267499,-0.26890208136082494,0.6441784738845056,0.33415393098060875,0.15691494952233764,0.5000248606913655,-0.5116437816080825,0.7911714620032564,-0.10834160724506248,-0.9113302643790999,-0.6598152781527546],
    [-0.9599432508197245,0.8496920150063474,-0.9897273749556663,-0.3330939754080635,-0.6538453515613978,-0.28371105142105657,-0.8857809918166692,-0.527717536680937,0.07000563479339439,-0.06985520629810216,0.7109340514172438,-0.8892324776988785,-0.45030417256003386,0.7354102077594544,-0.9277461032251146,0.171550220745448],
    [0.9318195262463393,0.884922939459218,-0.2155547564521929,0.2211634095636299,-0.23139894212759327,-0.27898580268462103,0.6694793338654823,-0.11636912934531107,0.23956768729191635,0.06613050952188404,-0.8108008125493282,0.9368809222362064,0.17888520043200407,0.2549255142552127,-0.7883105095800405,0.6626793238339577],
    [-0.3349922899751334,-0.055337973334820045,0.5659092483677477,0.7549723347009181,-0.939036673954488,-0.24278781789419845,0.2437283474300589,0.43161190183535014,-0.33192955151594195,0.7588550054822116,-0.29271863993297087,-0.7786129308390457,-0.9217692605139973,-0.8018188876991137,-0.5815494169507347,0.44052526952380555],
    [-0.5171707956516634,0.5365735831330811,-0.5084680752081203,0.4719379964971493,0.797828821859643,0.7148078884831288,-0.9606993301409337,0.9422295753234353,-0.8729619706333991,-0.7972051261564448,-0.9978074058276083,-0.8856350538621363,-0.51261212252995,0.7165837169403435,-0.2600011329965892,-0.22553620856810763],
    [-0.04307133200968405,-0.49526972397291225,-0.6694327036217644,-0.1375144501928358,-0.5199037798244022,0.5768144435473035,0.13872069353693295,-0.4477681140887948,-0.29435764608055637,-0.015360287279733154,0.7276813843538861,0.37040005103294016,-0.42749928677339843,-0.381518650544161,0.42940409408517866,-0.08578425330565409],
    [-0.8442914482705022,-0.4328814960098679,-0.9482784907628048,-0.27059512452123524,0.14616187925735202,-0.44050344529428864,-0.24420135702474388,-0.48716381555563215,-0.33524612977039103,0.15106301158627522,0.4234234541917816,0.9188185809646816,0.7245708667104611,-0.5106091643240642,0.7692918862614033,-0.5979130372656027],
    [-0.05323166645418009,0.19898874763216856,-0.693310027597779,0.8690926968837882,0.7024272144147452,-0.13632098920753055,0.18099225060778723,0.4764898907858508,0.6329825923579189,0.5599087336006239,0.14752814438148043,-0.19862356090339084,-0.33855365901789014,-0.6918562439506104,0.6401412485130447,-0.31422143884971687],
    [0.9198618964512271,-0.9085434574939062,-0.07565806068911662,-0.5494253827710445,0.2655614039368599,0.7131011737641324,0.8195949313694859,-0.6373292540641295,-0.9924840468123715,0.6923626169088277,-0.05621939843405466,-0.35653081712353885,-0.9999464658620689,-0.9724007384549824,-0.4092141782519212,-0.17291981592327632]];
    this.W2 = [[-0.3577785399646656,0.19300174833930894,-0.006247931821872665,-0.8640785144943233,-0.02636397037458016,0.7086929764697074,-0.9678527963144834,-0.6528626655876884],
    [-0.8253768261352405,-0.5671177169154191,0.45484305767531064,-0.3502346989348766,0.5027642260601599,0.6754540463944227,0.6722913264945145,0.6501012226470797],
    [0.0001865733031625183,0.458724910670786,-0.2177452837070506,0.4468517091545454,0.25435360000786034,0.29277504723796266,-0.9566132077960972,0.48135746733452667],
    [-0.3448112162036878,-0.8168772200028434,0.9534028337998839,-0.006687009797161192,-0.9738791702942908,-0.19962865313811973,-0.310342209791199,0.42073600626713015],
    [0.6253333109296606,0.08079836473626445,-0.4581749089956104,-0.1611345946541216,-0.7679920125565394,-0.3127490897928822,0.9255473754607166,0.8568138354035582],
    [0.12798230878247052,0.6038891999917286,-0.3883519523847543,-0.30585712183499725,0.6440931441235649,0.9252876045907121,-0.5594086705223642,0.007663229699182317],
    [0.7219221086185188,-0.24683674665622268,0.3827872283473197,-0.3436357568797552,0.7203935636829208,0.2375532962672091,-0.9799883919085213,-0.1725755052830915],
    [-0.4229865262763215,-0.2228762171613643,-0.1285303319236073,0.5383620068890687,0.3202337279810137,-0.4107217597963304,0.7387573999940131,0.48507772865651066],
    [-0.30578885404166023,0.38907862121743175,0.2850613686850756,0.6877775574427472,0.2510089890888705,0.07891071354268675,0.6498247861802171,0.8379924090901523],
    [0.22749370635787036,0.1441269023425953,0.8738984771258971,0.7576256801557939,-0.41046406704754634,0.5871947211165351,0.8656808011299617,-0.4830540021180436],
    [0.3415785307189019,0.7343372335559595,0.35452711802484504,0.3970927627552103,-0.045331450167483744,0.3503560110040054,-0.4228814864548194,0.49513411545656405],
    [-0.43683396365988925,-0.015800957077542144,-0.981984698921484,-0.6525929892334483,0.9193681216255052,0.25257372913001674,0.48451195693889515,0.4715518070160001],
    [-0.13563167917724828,0.955230751921623,0.1960298765599151,-0.837416481255524,0.28978650107148685,-0.20779296985066065,0.24205166488505547,0.05771624252686047],
    [0.2999035954230247,0.533600847938422,-0.8215696937345336,-0.7561650446156758,0.6164459874834067,-0.2875897301914634,0.6075447688909068,0.8152282805119482],
    [0.38207636404007017,-0.20030337081558036,0.3023005769479572,-0.5464676621096123,0.4681571154393058,-0.8019973567655523,-0.5396695832098306,-0.0019816954163731637],
    [-0.15441270390448025,0.7716264318518533,0.8001041489495355,0.11623169515432741,-0.7966311362008875,-0.08755901535460664,0.6739884060843058,0.352761899053315]];
    this.W3 = [[0.7057576147881934,0.9219819295243479,0.008765499139667732,0.667259636247759],
    [-0.5446038747597668,-0.6805166908504714,-0.37441332491553236,0.25178416326337105],
    [-0.1042499394145735,0.2415168476449776,0.04339011795775338,0.050055902361555216],
    [0.01816562158672408,-0.46254340365858715,-0.6123508169199359,-0.905285857093892],
    [-0.14302899427758398,-0.5681812147884573,-0.8700175214585144,0.21886674868890843],
    [0.881196814080278,0.6943194804855222,0.7264224475701275,-0.6629180709854321],
    [-0.32694951092932056,-0.7130330636451458,0.7228157845191001,0.8198034006003532],
    [-0.6154297460002565,-0.8661821182159262,-0.9342640326134513,0.04373167466890404]];    
    this.bias1 = [-0.0023758670168909646,-0.28712033623793687,0.0802088123987783,0.9835323525944566,0.8328840508572921,0.819850543760881,0.3782571437955151,0.24222685706252634,-0.2811048575880495,0.8036127051477568,-0.723446852992597,0.4343884619750362,-0.29447335005270503,-0.2920591626145539,0.6089586846600694,-0.7873644767872512];
    this.bias2 = [0.35559700438558917,0.9846998591793743,0.27425547868325717,0.1902335067128602,-0.05935915606134179,0.8365216092285905,-0.08262884558423567,-0.12391424026338305];
    this.bias3 = [-0.44763896832919414,0.804936458355908,0.7550132372322631,-0.5047491727149565];
    this.W = [this.W1, this.W2, this.W3];
    this.L = 4;
    this.bias = [this.bias1, this.bias2, this.bias3];
    this.a = [[],[],[]];
    this.output;
    this.input = [];
    //drawing informations
    this.offset_layer = [0,4.5,8.5,10.5];
    this.spacing = [1,5,9,13];
    this.nodeNumber = [this.W1.length, this.W2.length, this.W3.length, this.W3[0].length];
    this.diameter = 15;
    this.maxValue = 0;
    this.alpha = 100;

    this.relu = function(x){
        return max(0,x);
    }
    this.forwardPropagation = function(input){
        this.input = [...input];
        x = [...input];
        for(let l = 0; l < this.W.length; l++){
            for(let j = 0; j < this.W[l][0].length; j++){
                this.a[l][j] = 0;
                for(let i = 0; i < this.W[l].length; i++)
                    this.a[l][j] += this.W[l][i][j] * x[i];
                if(l != this.W.length-1)
                    this.a[l][j] = this.relu(this.a[l][j] + this.bias[l][j]);
                else
                    this.a[l][j] = this.a[l][j] + this.bias[l][j];
                if(this.a[l][j] > this.maxValue)
                    this.maxValue = this.a[l][j];
            }
            x = [...this.a[l]];
        }
        return x;
    }
    this.predict = function(input){
        this.y = this.forwardPropagation(input);
        this.output = this.y.indexOf(max(this.y));
        switch(this.output){
            case 0:
                res = LEFT_ARROW;
                break;
            case 1:
                res = DOWN_ARROW;
                break;
            case 2:
                res = RIGHT_ARROW;
                break;
            case 3:
                res = UP_ARROW;
                break;
        }
        return res;
    }
    this.drawNeuralNetwork = function(){
        for(let l = 0; l < this.L-1; l++){
            for(let i = 0, k = this.offset_layer[l]; i < this.nodeNumber[l]; i++, k++){
                for(let j = 0, h = this.offset_layer[l+1]; j < this.nodeNumber[l+1]; j++, h++){
                    if(l == 0)
                        stroke(map(this.input[i],0,1,200,20),this.alpha);
                    else
                        stroke(map(this.a[l-1][i],0,this.maxValue,200,20),this.alpha);
                    line(k*RESOLUTION_NEURALNETWORK, this.spacing[l]*RESOLUTION_NEURALNETWORK, 
                        h*RESOLUTION_NEURALNETWORK, this.spacing[l+1]*RESOLUTION_NEURALNETWORK);
                }
            }
        }
        // nodes
        stroke(0);
        for(let l = 0; l < this.L; l++){
            for(let i = 0, k = this.offset_layer[l]; i < this.nodeNumber[l]; i++, k++){
                switch(l){
                    case this.L-1:
                        fill(255);
                        if(i == this.output)
                            fill(0,0,255);
                        break;
                    case 0:
                        white = map(this.input[i],0,1,255,0);
                        fill(255,white,white);
                        break;
                    default:
                        white = map(this.a[l-1][i],0,this.maxValue,255,0);
                        fill(255,white,white);
                        break;
                }
                ellipse(k*RESOLUTION_NEURALNETWORK, this.spacing[l]*RESOLUTION_NEURALNETWORK, this.diameter);
            }
        }
        // output labels
        fill(0);
        text("L",this.offset_layer[this.L-1]*RESOLUTION_NEURALNETWORK-4,
            (this.spacing[this.L-1]+1)*RESOLUTION_NEURALNETWORK);
        text("D",(this.offset_layer[this.L-1]+1)*RESOLUTION_NEURALNETWORK-4,
            (this.spacing[this.L-1]+1)*RESOLUTION_NEURALNETWORK);
        text("R",(this.offset_layer[this.L-1]+2)*RESOLUTION_NEURALNETWORK-4,
            (this.spacing[this.L-1]+1)*RESOLUTION_NEURALNETWORK);
        text("U",(this.offset_layer[this.L-1]+3)*RESOLUTION_NEURALNETWORK-4,
            (this.spacing[this.L-1]+1)*RESOLUTION_NEURALNETWORK);
    }
}